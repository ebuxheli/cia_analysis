---
title: "Replication of Partners in Crime: An Empirical Evaluation of the CIA Rendition, Detention, and Interrogation Program"
author: "Enxhi Buxheli"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)

# attaching necessary libraries
library("foreign")
library("gdata")
library("plyr")
library("dplyr")
library("tidyr")
library("ggplot2")
library("stargazer")
library("plm")
library("Amelia")
library("MKmisc")
library("lmtest")
```

```{r, results='asis'}
## Data: There are three datasets used in this analysis: 
# 1. "pic_data_not_imputed.RData" - this is the initial dataset before imputation
# 2. "pic_data_imputed.RData" - this is the initial imputed dataset, contraining observations from 1991-2011 
# 3. "pic_data.RData" - this is the final dataset used in analysis

# Descriptive Statistics of Non-Imputed Dataset
load("dataverse_files/pic_data_not_imputed.RData") # Load unimputed data
stargazer(data, digits = 3) # Descriptive statistics of unimputed data

# Descriptative Statistics Imputed Dataset
load("dataverse_files/pic_data_imputed.RData") # Load Imputed Data
imps <- length(data.out$imputations) # Set number of imputations

# Not quite sure what the missmap is for. I believe it's to see how much data
# there is and the percentage missing for data diagnostics and quality checks. 
# I don't think this will be necessary for the replcation.
# missmap(data.out, legend = F, col = c("indianred", "dodgerblue"),  
#         main = "Missing Values in Initial, Non-Imputed, Dataset",
#         y.labels = NULL, y.at = NULL, 
#         y.cex = 0.6, x.cex = 0.85, margins = c(0, 0))
```

```{r}
dataCountry <- select(data, c("YEAR", "COW", "country", "ucdp_type3", "gtd", "log_USmilaid"))

# TSCS Plots of Saudi Arabia and Niger. Need to look up what TSCS plots are and
# why they take so long to load because that is incredibly annoying. Also, these
# plots don't seem to have been used in the actual publication.
# Global Terrorism Database
# tscsPlot(data.out, cs = "670", main = "GTD for Saudi Arabia", var = "gtd", ylim = c(-150, 150))
```

```{r fig1}
#--------------------------------------------------------------------
# In this section we plot six figures showing human rights trends across 
# eight indicators. The first two figures (Part A) are of global human rights trends; 
# the second two (Part B) break global trends down by participation; and the final 
# two (Part C) compare at the human rights practices of non-democracies that 
# participated in the program with those that did not. 
#--------------------------------------------------------------------

load("dataverse_files/pic_data.RData") # Load final dataset and take average of imputed datasets for plotting (same as above)
data.out <- data

data <- data.out$imputations[[1]] #for intial run. See original code for actual mean calculations.

#--------------------------------------------
# Part A. Plotting Global Human Rights Trends 
#--------------------------------------------

# Compute global-year averages for all DVs
trends <- data %>% group_by(YEAR) %>% 
  summarise("Physical Integrity Score (CIRI)" = mean(PHYSINT, na.rm = TRUE),
            "Latent Variable Model Score (Fariss)" = mean(latentmean, na.rm = TRUE),
            "State Department Score (PTS)" = mean(State, na.rm = TRUE), 
            "Amnesty International Score (PTS)"  = mean(Amnesty, na.rm = TRUE),
            "Extrajudicial Killing Score (CIRI)" = mean(KILL, na.rm = TRUE),
            "Political Imprisonment Score (CIRI)" = mean(POLPRIS, na.rm = TRUE),
            "Torture Score (CIRI)" = mean(TORT, na.rm = TRUE), 
            "Disappearance Score (CIRI)" = mean(DISAP, na.rm = TRUE))
# List of DV names
DVs <- c("Physical Integrity Score (CIRI)", "Latent Variable Model Score (Fariss)", "Disappearance Score (CIRI)", "Political Imprisonment Score (CIRI)", "Amnesty International Score (PTS)", "State Department Score (PTS)", "Extrajudicial Killing Score (CIRI)", "Torture Score (CIRI)")
graph_data <- gather(trends, type, value, DVs) # Reformat data for graphs 
graph_data$type <- factor(graph_data$type, levels = DVs) # Converts labels to factors to order plot facets 

# The following code creates two dataframes used to set the y-axis range on the facet plots 
facetlims1 <- as.data.frame(cbind(YEAR = c(rep(1992:2011, times = 4)), 
                                  value = c(rep(c(0,8), 10), rep(c(-0.5,1), 10), rep(c(0,2), 10), rep(c(0,2), 10))))
facetlims2 <- as.data.frame(cbind(YEAR = c(rep(1992:2011, times = 4)),
                                  value = c(rep(c(1,5), 10), rep(c(1,5), 10), rep(c(0,2), 10), rep(c(0,2), 10))))
facetlims1$type <- rep(DVs[1:4], times = 1, each = 20) # Assign variable names
facetlims2$type <- rep(DVs[5:8], times = 1, each = 20)
facetlims1$type <- factor(facetlims1$type, levels = DVs) # Converts labels to factors to order plot facets 
facetlims2$type <- factor(facetlims2$type, levels = DVs)

# Subset data to be graphed
graph1 <- subset(graph_data, (graph_data$type %in% DVs[1:4]))
graph2 <- subset(graph_data, (graph_data$type %in% DVs[5:8]))

# Create plots
## This is the plot for figure 1
ggplot(graph1, aes(x=YEAR, y=value)) +
  geom_line() + theme_bw() + facet_wrap(~type, ncol=2, scales = "free") +
  #ggtitle("Respect for Human Rights, 1992-2011") +
  labs(x = "Year", y = "Lower Score = More Abuse; Higher Score = More Respect") +
  geom_vline(xintercept = seq(2001, 2005, by = 0.001), colour="grey", linetype = "solid", alpha = 0.01) +
  geom_blank(data = facetlims1) +
  theme(legend.position= "bottom", legend.title=element_blank(), 
        plot.title = element_text(hjust = 0.5, size=14), 
        text = element_text(size = 13),
        axis.title = element_text(size = 13), axis.text = element_text(size = 10))

# This plot was not used in the actual paper
# ggplot(graph2, aes(x=YEAR, y=value)) +
#   geom_line() + theme_bw() + facet_wrap(~type, ncol=2, scales = "free") +
#   #ggtitle("Respect for Human Rights, 1992-2011") +
#   labs(x = "Year", y = "Lower Score = More Abuse; Higher Score = More Respect") +
#   geom_vline(xintercept = seq(2001, 2005, by = 0.001), colour="grey", linetype = "solid", alpha = 0.01) +
#   geom_blank(data = facetlims2) +
#   theme(legend.position= "bottom", legend.title=element_blank(), 
#         plot.title = element_text(hjust = 0.5, size=14), 
#         text = element_text(size = 13),
#         axis.title = element_text(size = 13), axis.text = element_text(size = 10))
```



